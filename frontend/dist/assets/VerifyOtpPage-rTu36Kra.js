import{j as e}from"./query-Bv2YtT6Q.js";import{u as L,e as E,r as n,b as I}from"./vendor-DW262YiZ.js";import{u as M}from"./useAuth-CpnnWU2w.js";import{v as S,o as O}from"./index-QTZiQ_WQ.js";import{F as R,O as $,B as N,L as W}from"./FormField-DcLSszBB.js";import"./supabase-BQbgwcOn.js";const y=60;function G(){const t=L(),r=E(),{verifyOtp:a,signInWithEmail:d,signInWithPhone:u,isLoading:m}=M(),s=t.state,[i,f]=n.useState(""),[h,l]=n.useState(""),[c,x]=n.useState(y),[w,p]=n.useState(!1);if(!(s!=null&&s.type)||!(s!=null&&s.contact))return e.jsx(I,{to:"/login",replace:!0});n.useEffect(()=>{if(c<=0)return;const o=setInterval(()=>{x(v=>v-1)},1e3);return()=>clearInterval(o)},[c]),n.useEffect(()=>{i.length===6&&g()},[i]);const g=n.useCallback(async()=>{var b;l("");const o=S(O,{otp:i});if(!o.success){l(((b=o.errors)==null?void 0:b.otp)??"Código inválido");return}await a(i,s.type,s.contact)||f("")},[i,s,a]),k=n.useCallback(async()=>{p(!0),l(""),(s.type==="email"?await d(s.contact):await u(s.contact))&&x(y),p(!1)},[s,d,u]),C=()=>{r("/login")},j=s.type==="email"?B(s.contact):F(s.contact);return e.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-surface-950 via-surface-900 to-surface-950",children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:e.jsx("div",{className:"absolute -top-1/2 -right-1/2 w-full h-full bg-gradient-to-bl from-primary-500/10 to-transparent rounded-full blur-3xl"})}),e.jsxs("div",{className:"relative w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-primary-500 to-primary-600 shadow-lg shadow-primary-500/30 mb-4",children:s.type==="email"?e.jsx(D,{className:"w-8 h-8 text-white"}):e.jsx(P,{className:"w-8 h-8 text-white"})}),e.jsxs("h1",{className:"text-2xl font-bold text-white mb-2",children:["Verificá tu ",s.type==="email"?"email":"teléfono"]}),e.jsx("p",{className:"text-surface-400",children:s.type==="email"?e.jsxs(e.Fragment,{children:["Ingresá el código del link que enviamos a ",e.jsx("strong",{className:"text-surface-200",children:j})]}):e.jsxs(e.Fragment,{children:["Ingresá el código de 6 dígitos que enviamos a ",e.jsx("strong",{className:"text-surface-200",children:j})]})})]}),e.jsxs("div",{className:"bg-surface-900/80 backdrop-blur-xl border border-surface-800 rounded-2xl p-6 shadow-xl",children:[e.jsxs("form",{onSubmit:o=>{o.preventDefault(),g()},className:"space-y-6",children:[e.jsx(R,{label:"Código de verificación",error:h,children:e.jsx($,{value:i,onChange:f,error:!!h,disabled:m})}),e.jsx(N,{type:"submit",fullWidth:!0,isLoading:m,size:"lg",disabled:i.length!==6,children:"Verificar"})]}),e.jsx("div",{className:"mt-6 text-center",children:c>0?e.jsxs("p",{className:"text-sm text-surface-400",children:["Podés reenviar en"," ",e.jsx("span",{className:"font-mono text-surface-200",children:V(c)})]}):e.jsx(N,{variant:"ghost",onClick:k,isLoading:w,children:"Reenviar código"})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-surface-800 text-center",children:e.jsx(W,{variant:"secondary",onClick:C,children:"← Usar otro método"})})]}),e.jsxs("div",{className:"mt-6 p-4 bg-surface-800/50 rounded-xl border border-surface-700",children:[e.jsx("h3",{className:"text-sm font-medium text-surface-200 mb-2",children:"¿No recibiste el código?"}),e.jsxs("ul",{className:"text-xs text-surface-400 space-y-1",children:[e.jsx("li",{children:"• Revisá tu carpeta de spam"}),e.jsxs("li",{children:["• Verificá que el ",s.type==="email"?"email":"número"," sea correcto"]}),e.jsx("li",{children:"• Esperá unos segundos y reenviá"})]})]})]})]})}function B(t){const[r="",a=""]=t.split("@");return r.length<=3?`${r.slice(0,1)}***@${a}`:`${r.slice(0,2)}***${r.slice(-1)}@${a}`}function F(t){const r=t.replace(/\D/g,"");return r.length<=4?"****":`***${r.slice(-4)}`}function V(t){const r=Math.floor(t/60),a=t%60;return`${r}:${a.toString().padStart(2,"0")}`}function D({className:t}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}function P({className:t}){return e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}export{G as default};
//# sourceMappingURL=VerifyOtpPage-rTu36Kra.js.map
